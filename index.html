<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>ESY</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="esy">
<meta property="og:type" content="website">
<meta property="og:title" content="ESY">
<meta property="og:url" content="https://esyyes.github.io/index.html">
<meta property="og:site_name" content="ESY">
<meta property="og:description" content="esy">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="esy">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="ESY" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ESY</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://esyyes.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/04/hello-world/" class="article-date">
  <time datetime="2020-11-04T09:21:06.118Z" itemprop="datePublished">2020-11-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/04/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/11/04/hello-world/" data-id="ckh4h5f4s001misuecagn8s0l" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-分类模型的评估指标" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/03/%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87/" class="article-date">
  <time datetime="2020-11-03T02:07:46.000Z" itemprop="datePublished">2020-11-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/03/%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87/">分类模型的评估指标</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="分类模型的评估指标"><a href="#分类模型的评估指标" class="headerlink" title="分类模型的评估指标"></a>分类模型的评估指标</h1><p> <a target="_blank" rel="noopener" href="https://github.com/apachecn/sklearn-doc-zh/blob/master/docs/master/32.md">https://github.com/apachecn/sklearn-doc-zh/blob/master/docs/master/32.md</a> </p>
<h2 id="混淆矩阵"><a href="#混淆矩阵" class="headerlink" title="混淆矩阵"></a>混淆矩阵</h2><p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5/10087822">https://baike.baidu.com/item/%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5/10087822</a></p>
<p>评估分类器性能的最好方法是<strong>混淆矩阵</strong>。</p>
<p>在讲矩阵之前，我们先复习下之前在讲分类评估指标中定义的一些符号含义，如下：</p>
<p>**TP(True Positive)**：将正类预测为正类数，真实为0，预测也为0</p>
<p>**FN(False Negative)**：将正类预测为负类数，真实为0，预测为1</p>
<p>**FP(False Positive)**：将负类预测为正类数， 真实为1，预测为0</p>
<p>**TN(True Negative)**：将负类预测为负类数，真实为1，预测也为1</p>
<p><img src="../images/u=3900275624,1281499515&fm=173&app=49&f=JPEG.jpg"></p>
<h2 id="精度（precision）"><a href="#精度（precision）" class="headerlink" title="精度（precision）"></a>精度（precision）</h2><p> <a target="_blank" rel="noopener" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.precision_score.html#sklearn.metrics.precision_score">https://scikit-learn.org/stable/modules/generated/sklearn.metrics.precision_score.html#sklearn.metrics.precision_score</a> </p>
<p> 精度是表示观测值与真值的接近程度。每一种<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%89%A9%E7%90%86%E9%87%8F/9984692">物理量</a>要用<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%95%B0%E5%80%BC/2013853">数值</a>表示时，必须先要制定一种标准，并选定一种单位 (unit)。这种标准的制定，通常是根据人们对于所要测量的物理量的认识与了解，并且要考虑这标准是否容易复制，或测量的过程是否容易操作等实际问题。 </p>
<p> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Precision_and_recall#Precision">precision</a> 是 the ability of the classifier not to label as positive a sample that is negative （classifier （分类器）的标签不能被标记为正的样本为负的能力），并且 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Precision_and_recall#Recall">recall</a> 是 classifier （分类器）查找所有 positive samples （正样本）的能力。<br>$$<br>precision = TP/(TP+FP)<br>$$<br>TP是真正类的数量，FP是假正类的数量。</p>
<h2 id="召回（recall）-灵敏度（sensitivity）"><a href="#召回（recall）-灵敏度（sensitivity）" class="headerlink" title="召回（recall）/灵敏度（sensitivity）"></a>召回（recall）/灵敏度（sensitivity）</h2><p>$$<br>recall = TP/(TP+FN)<br>$$</p>
<p>分类器正确检测到的正类实例的比例。</p>
<h2 id="F1分数"><a href="#F1分数" class="headerlink" title="F1分数"></a>F<del>1</del>分数</h2><p>F<del>1</del>分数是精度和召回率的谐波平均值。正常的平均值平等对待所有的值，而谐波平均值会给予较低的值更高的权重。因此，只有当召回率和精度都很高时，分类器才能得到较高的F<del>1</del>分数。<br>$$<br>F1 =TP/(TP+(FN+FP)/2)<br>$$</p>
<h2 id="Kappa检验"><a href="#Kappa检验" class="headerlink" title="Kappa检验"></a>Kappa检验</h2><p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/kappa%E7%B3%BB%E6%95%B0/9385025?fr=aladdin">https://baike.baidu.com/item/kappa%E7%B3%BB%E6%95%B0/9385025?fr=aladdin</a></p>
<p> Kappa系数用于<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%B8%80%E8%87%B4%E6%80%A7%E6%A3%80%E9%AA%8C/295624">一致性检验</a>，也可以用于衡量分类<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%B2%BE%E5%BA%A6/5167954">精度</a>，但kappa系数的计算是基于<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5/10087822">混淆矩阵</a>的 </p>
<p> kappa系数是一种衡量分类精度的指标。它是通过把所有地表真实分类中的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%83%8F%E5%85%83">像元</a>总数（N）乘以<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5">混淆矩阵</a>对角线（Xkk）的和，再减去某一类地表真实像元总数与该类中被分类像元总数之积对所有类别求和的结果，再除以总像元数的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B9%B3%E6%96%B9">平方</a>减去某一类地表真实像元总数与该类中被分类像元总数之积对所有类别求和的结果所得到的 </p>
<p><img src="../images/1604371707587.png" alt="1604371707587"></p>
<p> kappa score （参阅 docstring ）是 -1 和 1 之间的数字。 <strong>.8 以上的 scores</strong> 通常被认为是很好的 agreement （协议）; 0 或者 更低表示没有 agreement （实际上是 random labels （随机标签））。 </p>
<p> kappa计算结果为-1<del>1，但通常kappa是落在 0</del>1 间，可分为五组来表示不同级别的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%B8%80%E8%87%B4%E6%80%A7">一致性</a>：0.0<del>0.20极低的一致性(slight)、0.21</del>0.40一般的一致性(fair)、0.41<del>0.60 中等的一致性(moderate)、0.61</del>0.80 高度的一致性(substantial)和0.81~1几乎完全一致(almost perfect)。 </p>
<p><img src="../images/1c4a3da551e79b896802267d.jpg"></p>
<p>If this coefficient takes a value between 0.81 and 1, it is<br>considered that there is almost perfect agreement between the results (Landis &amp; Koch, 1977). </p>
<p><img src="../images/4b90f603738da977587f1692b151f8198618e333.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/11/03/%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87/" data-id="ckh4h5f7h005oisuefowpa0md" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-10-21-爬虫基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/21/10-21-%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2020-10-21T13:41:47.000Z" itemprop="datePublished">2020-10-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/py-study/">py_study</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/21/10-21-%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80/">10-21 爬虫基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="10-21-爬虫基础"><a href="#10-21-爬虫基础" class="headerlink" title="10-21 爬虫基础"></a>10-21 爬虫基础</h1><p>URI的全称为 Uniform Resource Identifier ，即统一资源标志符，URL 的全称为 Universal Resource Locator ，即统一资源定位符 .</p>
<p>URI还包括一个子类 叫作 URN ，它的全称为 Universal Resource  Name ，即统一资源、名 称 </p>
<p> 超文本，其英文名称叫作 hypertext </p>
<p>HTTP 的全称是 Hyper Text  Transfer  Protocol ，中文名 叫作超文本传输协议 。 HTTP 协议是用于从网络传输超文本数据到本地浏览器的传送协议，它能保证高效而准确地传送超文本文档。 HTTP 由万维网协会（ World Wide Web Consortium ）和 Internet 工作小组 IETF ( Internet Engineering Task Force ) 共同合作制定的规范，目前广泛使用的是 HTTP 1.1 版本</p>
<p>HTTPS 的全称是 Hyper Text Transfer Protocol  over Secure  Socket Layer ，是以安全为目标的 HTTP 通道，简单讲是 HTTP 的安全版， 即 HTTP 下加入 SSL 层 ，简称为 HTTPS </p>
<h1 id="10-22-urllib学习"><a href="#10-22-urllib学习" class="headerlink" title="10-22 urllib学习"></a>10-22 urllib学习</h1><p>首先，了解一下 urllib 库，它是 Python 内置的 HTTP 请求库 ，也就是说不需要额外安装即可使用它包含如下 4 个模块。</p>
<p>口 request ： 它是最基本的 HTTP 请求模块，可以用来模拟发送请求 。 就像在浏览器里输入网挝然后回车一样，只需要给库方法传入 URL 以及额外的参数，就可以模拟实现这个过程了 。</p>
<p>口 error ： 异常处理模块，如果出现请求错误 ， 我们可以捕获这些异常，然后进行重试或其他操作以保证程序不会意外终止。</p>
<p>口 parse ： 一个工具模块，提供了许多 URL 处理方法，比如拆分、解析 、 合并等。</p>
<p>口 robotparser ：主要是用来识别网站的 robots.txt 文件，然后判断哪些网站可以爬，哪些网站不可以爬，它其实用得 比较少。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/10/22</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"></span><br><span class="line"><span class="comment"># python官网</span></span><br><span class="line">response = urllib.request.urlopen(<span class="string">&#x27;https://www.python.org&#x27;</span>)</span><br><span class="line">print(response.read().decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">print(<span class="built_in">type</span>(response))</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">http</span>.<span class="title">client</span>.<span class="title">HTTPResponse</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">它是一个 <span class="title">HTTPResposne</span> 类型的对象，主要包含 <span class="title">read</span> （） 、 <span class="title">read</span> <span class="title">into</span> （）、 <span class="title">getheader</span>(<span class="params">name ）、gethea ders （） 、 file no （）等方法，以及 msg 、 version 、 status 、 reason 、 debuglevel 、 ιlosed 等属性 。</span></span></span><br><span class="line"><span class="class"><span class="params"></span></span></span><br><span class="line"><span class="class"><span class="params"><span class="built_in">print</span>(<span class="params">response.status</span>)</span></span></span><br><span class="line"><span class="class"><span class="params"><span class="built_in">print</span>(<span class="params">response.getheaders(<span class="params"></span>)</span>)</span></span></span><br><span class="line"><span class="class"><span class="params"><span class="built_in">print</span>(<span class="params">response.getheader(<span class="params"><span class="string">&#x27;Server&#x27;</span></span>)</span>)</span></span></span><br></pre></td></tr></table></figure>



<h1 id="10-22-request学习"><a href="#10-22-request学习" class="headerlink" title="10-22 request学习"></a>10-22 request学习</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/10/21/10-21-%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80/" data-id="ckh4h5f3n0001isuehgmt9hji" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/py-study/" rel="tag">py_study</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-CRF的整体流程结果" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/25/CRF%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%E7%BB%93%E6%9E%9C/" class="article-date">
  <time datetime="2020-09-25T08:29:13.000Z" itemprop="datePublished">2020-09-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/nlp/">nlp</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/25/CRF%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%E7%BB%93%E6%9E%9C/">CRF的整体流程结果</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h2><p>基于半监督学习**<strong>XX算法的CRF模型</strong></p>
<p><strong>（初步概述）</strong></p>
<p><strong>模型：</strong></p>
<p>模型可识别、可预测、可使用。先识别包含实体的语句，再分类保存。</p>
<p>模型输入：大量英文文本</p>
<p>模型输出：1 符合要求的语句；0 包含部分三要素且不符合要求的语句。</p>
<p><strong>词典：</strong></p>
<p>标志词词典是关键，其他两类命名实体可加入现有的预训练模型（如stanford-ner，Bert进行识别。</p>
<p>词典可用来匹配，可用来验证。</p>
<p><strong>四组测试：</strong></p>
<p>基于CRF；</p>
<p>基于CRF然后基于词典对初步识别结果进行校正；</p>
<p>基于半监督学习<strong>XX**</strong>算法**对CRF进行迭代学习；</p>
<p>基于半监督学习XX算法对CRF进行迭代学习然后基于词典对初步识别结果进行校正。</p>
<p><strong>评价指标：</strong></p>
<table>
<thead>
<tr>
<th>评价指标</th>
<th>计算公式</th>
</tr>
</thead>
<tbody><tr>
<td>精确率（P）</td>
<td>识别出正确语句数/识别出语句总数</td>
</tr>
<tr>
<td>召回率（R）</td>
<td>识别出正确语句数/标准集</td>
</tr>
<tr>
<td>F值（F-Measure）</td>
<td>(2<em>P</em>R)/(P+R)</td>
</tr>
</tbody></table>
<h2 id="run-crf"><a href="#run-crf" class="headerlink" title="run_crf"></a>run_crf</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/25</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> creata_data <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sklearn_crfsuite</span><br><span class="line"><span class="keyword">from</span> save_data <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取语料和标志词</span></span><br><span class="line">input_data = np.array(pd.read_excel(<span class="string">&quot;9-25data.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">0</span>]).tolist()</span><br><span class="line">symbol = np.array(pd.read_excel(<span class="string">&quot;9-25symbol_data.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">0</span>]).tolist()</span><br><span class="line"></span><br><span class="line"><span class="comment"># m代表划分的训练集多少个，剩下的都为测试集，不要大于全部的数据</span></span><br><span class="line">m = <span class="number">60</span></span><br><span class="line"><span class="comment"># 进行处理</span></span><br><span class="line">X_train, y_train, X_test, y_test = create_train_data(input_data, symbol, m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型训练</span></span><br><span class="line">crf = sklearn_crfsuite.CRF(algorithm=<span class="string">&#x27;lbfgs&#x27;</span>, c1=<span class="number">1</span>, c2=<span class="number">0.1</span>, max_iterations=<span class="number">100</span>, all_possible_transitions=<span class="literal">True</span>)</span><br><span class="line">crf.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 去除标签里面的【O】</span></span><br><span class="line">labels = <span class="built_in">list</span>(crf.classes_)</span><br><span class="line">labels.remove(<span class="string">&#x27;O&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分别对训练集和测试集进行预测</span></span><br><span class="line">y_train_pred = crf.predict(X_train)</span><br><span class="line">y_test_pred = crf.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存训练集和预测及的结果</span></span><br><span class="line">data0, data1, num_train, num_test = save_data(y_train_pred, y_test_pred, input_data, m)</span><br><span class="line">true_train, true_test = class_result(y_train, y_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出每个词的训练集下和测试集下的结果</span></span><br><span class="line">print_result(y_test, y_test_pred, y_train, y_train_pred, labels)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出句子的预测结果</span></span><br><span class="line">target_names = [<span class="string">&#x27;class 0&#x27;</span>, <span class="string">&#x27;class 1&#x27;</span>]</span><br><span class="line">print(<span class="string">f&quot;训练集下：&quot;</span>)</span><br><span class="line">print(<span class="string">f&quot;<span class="subst">&#123;classification_report(true_train, num_train, target_names=target_names)&#125;</span>&quot;</span>)</span><br><span class="line">print(<span class="string">f&quot;测试集下：&quot;</span>)</span><br><span class="line">print(<span class="string">f&quot;<span class="subst">&#123;classification_report(true_test, num_test, target_names=target_names)&#125;</span>&quot;</span>)</span><br><span class="line">print(<span class="string">f&quot;所有数据下：&quot;</span>)</span><br><span class="line">print(<span class="string">f&quot;<span class="subst">&#123;classification_report(true_train+true_test, num_train+num_test, target_names=target_names)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="create-data"><a href="#create-data" class="headerlink" title="create_data"></a>create_data</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/09/25/CRF%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%E7%BB%93%E6%9E%9C/" data-id="ckh4h5f3v0007isue9ti321qn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nlp/" rel="tag">nlp</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-nlp-crf模型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/25/nlp-crf%E6%A8%A1%E5%9E%8B/" class="article-date">
  <time datetime="2020-09-25T07:42:57.000Z" itemprop="datePublished">2020-09-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/nlp/">nlp</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/25/nlp-crf%E6%A8%A1%E5%9E%8B/">nlp_crf模型</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="nlp-crf模型"><a href="#nlp-crf模型" class="headerlink" title="nlp_crf模型"></a>nlp_crf模型</h1><h2 id="sklearn-crfsuite的安装"><a href="#sklearn-crfsuite的安装" class="headerlink" title="sklearn-crfsuite的安装"></a>sklearn-crfsuite的安装</h2><p>直接pip install sklearn_crfsuite即可</p>
<h2 id="总结一些链接"><a href="#总结一些链接" class="headerlink" title="总结一些链接"></a>总结一些链接</h2><p>对sklearn_crfsuite的一些相关介绍 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/74408364">https://zhuanlan.zhihu.com/p/74408364</a> </p>
<p>基于 CRF 的中文命名实体识别模型实现 <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7fa260e91382">https://www.jianshu.com/p/7fa260e91382</a> </p>
<p>NLP关键词提取方法总结及实现 <a target="_blank" rel="noopener" href="https://blog.csdn.net/asialee_bird/article/details/96454544">https://blog.csdn.net/asialee_bird/article/details/96454544</a> </p>
<p>使用CRF++实现命名实体识别(NER) <a target="_blank" rel="noopener" href="https://blog.csdn.net/BF02jgtRS00XKtCx/article/details/93806235?utm_medium=distribute.pc_relevant_download.none-task-blog-baidujs-4.nonecase&amp;depth_1-utm_source=distribute.pc_relevant_download.none-task-blog-baidujs-4.nonecase">https://blog.csdn.net/BF02jgtRS00XKtCx/article/details/93806235?utm_medium=distribute.pc_relevant_download.none-task-blog-baidujs-4.nonecase&amp;depth_1-utm_source=distribute.pc_relevant_download.none-task-blog-baidujs-4.nonecase</a> </p>
<p>基于gensim TFIDF模型 的文章推荐算法 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34333481/article/details/85327090?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-5-85327090.nonecase&utm_term=gensim%E4%BF%9D%E5%AD%98%E6%A8%A1%E5%9E%8B">https://blog.csdn.net/qq_34333481/article/details/85327090?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2<del>all</del>first_rank_v2~rank_v25-5-85327090.nonecase&amp;utm_term=gensim%E4%BF%9D%E5%AD%98%E6%A8%A1%E5%9E%8B</a> </p>
<p>标注训练——crfsuite <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/613ea47e98e7">https://www.jianshu.com/p/613ea47e98e7</a> </p>
<p>基于crf的CoNLL2002数据集命名实体识别模型实现-pycrfsuite <a target="_blank" rel="noopener" href="https://blog.csdn.net/leitouguan8655/article/details/83382412">https://blog.csdn.net/leitouguan8655/article/details/83382412</a> </p>
<p>Let’s use CoNLL 2002 data to build a NER system [<a target="_blank" rel="noopener" href="https://nbviewer.jupyter.org/github/tpeng/python-crfsuite/blob/master/examples/CoNLL%202002.ipynb]">https://nbviewer.jupyter.org/github/tpeng/python-crfsuite/blob/master/examples/CoNLL%202002.ipynb]</a>(<a target="_blank" rel="noopener" href="https://nbviewer.jupyter.org/github/tpeng/python-crfsuite/blob/master/examples/CoNLL">https://nbviewer.jupyter.org/github/tpeng/python-crfsuite/blob/master/examples/CoNLL</a> 2002.ipynb) </p>
<h3 id="Tutorial官网对CRF的使用"><a href="#Tutorial官网对CRF的使用" class="headerlink" title="Tutorial官网对CRF的使用"></a>Tutorial官网对CRF的使用</h3><p> <a target="_blank" rel="noopener" href="https://sklearn-crfsuite.readthedocs.io/en/latest/tutorial.html#">https://sklearn-crfsuite.readthedocs.io/en/latest/tutorial.html#</a> </p>
<h2 id="姓名语料建立"><a href="#姓名语料建立" class="headerlink" title="姓名语料建立"></a>姓名语料建立</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/23</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> gensim <span class="keyword">import</span> corpora, models, similarities</span><br><span class="line"><span class="keyword">import</span> en_core_web_md</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nlp = en_core_web_md.load()</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取姓名</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;en_name.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    result.append(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, line[:<span class="number">-1</span>].split(<span class="string">&#x27;,&#x27;</span>))))</span><br><span class="line">f.close()</span><br><span class="line">result.pop(<span class="number">0</span>)</span><br><span class="line">result.insert(<span class="number">0</span>, [<span class="string">&#x27;aadi&#x27;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 变成小写去重</span></span><br><span class="line">data = [result[i][<span class="number">0</span>].lower() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result))]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将其转换为词典</span></span><br><span class="line">doc = [[text] <span class="keyword">for</span> text <span class="keyword">in</span> <span class="built_in">list</span>(<span class="built_in">set</span>(data))]</span><br><span class="line"></span><br><span class="line">dictionary = corpora.Dictionary(doc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存生成的词典</span></span><br><span class="line">dictionary.save(<span class="string">&#x27;train_dictionary.dict&#x27;</span>)</span><br><span class="line"></span><br><span class="line">corpus = [dictionary.doc2bow(text) <span class="keyword">for</span> text <span class="keyword">in</span> doc]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将语料转换为tf-idf的索引</span></span><br><span class="line">tfidf_model = models.TfidfModel(corpus)[corpus]</span><br><span class="line"></span><br><span class="line">tfidf_model.save(<span class="string">&#x27;train_tfidf.model&#x27;</span>)</span><br><span class="line"></span><br><span class="line">index = similarities.MatrixSimilarity(tfidf_model)</span><br><span class="line"></span><br><span class="line">index.save(<span class="string">&#x27;train_index.index&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="提取中文英文姓名"><a href="#提取中文英文姓名" class="headerlink" title="提取中文英文姓名"></a>提取中文英文姓名</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/23</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> gensim <span class="keyword">import</span> corpora, models, similarities</span><br><span class="line"><span class="keyword">import</span> en_core_web_md</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nlp = en_core_web_md.load()</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取姓名</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;en_name.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    result.append(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, line[:<span class="number">-1</span>].split(<span class="string">&#x27;,&#x27;</span>))))</span><br><span class="line">f.close()</span><br><span class="line">result.pop(<span class="number">0</span>)</span><br><span class="line">result.insert(<span class="number">0</span>, [<span class="string">&#x27;aadi&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 变成小写</span></span><br><span class="line">data = [result[i][<span class="number">0</span>].lower() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result))]</span><br><span class="line"><span class="comment"># 去除里面的停靠词</span></span><br><span class="line">df = [word <span class="keyword">for</span> word <span class="keyword">in</span> data <span class="keyword">if</span> <span class="keyword">not</span> nlp.vocab[word].is_stop != <span class="literal">False</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取中文姓名</span></span><br><span class="line">cn_name = np.array(pd.read_excel(<span class="string">&quot;cn_name.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">1</span>][<span class="number">0</span>:<span class="number">100</span>]).tolist()</span><br><span class="line"></span><br><span class="line">ccname = <span class="built_in">list</span>(<span class="built_in">set</span>(cn_name))</span><br><span class="line">all_name = ccname + df</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 将其转换为词典</span></span><br><span class="line">dictionary = corpora.Dictionary([[text] <span class="keyword">for</span> text <span class="keyword">in</span> all_name])</span><br><span class="line">corpus = [dictionary.doc2bow([text]) <span class="keyword">for</span> text <span class="keyword">in</span> all_name]</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 将语料转换为tf-idf的索引</span></span><br><span class="line">tfidf_model = models.TfidfModel(corpus)[corpus]</span><br><span class="line">index = similarities.MatrixSimilarity(tfidf_model)</span><br><span class="line"></span><br><span class="line">stop_words = [<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_stop</span>(<span class="params">lines</span>):</span></span><br><span class="line">    token_doc = [token.lemma_ <span class="keyword">for</span> token <span class="keyword">in</span> nlp(lines.lower())]</span><br><span class="line">    key_word = []</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> token_doc:</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> stop_words:</span><br><span class="line">            key_word.append(word)</span><br><span class="line">    <span class="keyword">return</span> key_word</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">input_data = pd.read_excel(<span class="string">&quot;data.xlsx&quot;</span>, header=<span class="literal">None</span>)</span><br><span class="line">df = np.array(input_data).tolist()</span><br><span class="line">symbol = np.array(pd.read_excel(<span class="string">&quot;标志词.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">0</span>]).tolist()</span><br><span class="line">time = [<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;day&#x27;</span>, <span class="string">&#x27;minute&#x27;</span>, <span class="string">&#x27;second&#x27;</span>, <span class="string">&#x27;today&#x27;</span>, <span class="string">&#x27;tomorrow&#x27;</span>, <span class="string">&#x27;yesterday&#x27;</span>, <span class="string">&#x27;morning&#x27;</span>, <span class="string">&#x27;bainoon&#x27;</span>, <span class="string">&#x27;afternoon&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;evening&#x27;</span>, <span class="string">&#x27;tonight&#x27;</span>, <span class="string">&#x27;night&#x27;</span>]</span><br><span class="line">x = [<span class="string">&#x27;%s&#x27;</span> % i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">2022</span>)]</span><br><span class="line">jie = [<span class="string">&#x27;in&#x27;</span>, <span class="string">&#x27;as&#x27;</span>, <span class="string">&#x27;at&#x27;</span>, <span class="string">&#x27;the&#x27;</span>]</span><br><span class="line"></span><br><span class="line">years = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">203</span>):</span><br><span class="line">    c = <span class="number">10</span> * i</span><br><span class="line">    years.append(<span class="string">&#x27;%s&#x27;</span> % c + <span class="string">&#x27;s&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">label = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(df)):</span><br><span class="line">    keys = del_stop(df[i][<span class="number">0</span>])</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> words <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="keyword">if</span> words <span class="keyword">not</span> <span class="keyword">in</span> symbol:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> num &gt; <span class="number">0</span>:</span><br><span class="line">        label.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        label.append(<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># if num &gt; 0:</span></span><br><span class="line">    <span class="comment">#     num1 = 0</span></span><br><span class="line">    <span class="comment">#     num2 = 0</span></span><br><span class="line">    <span class="comment">#     for index in range(len(keys)):</span></span><br><span class="line">    <span class="comment">#         if keys[index] not in symbol:</span></span><br><span class="line">    <span class="comment">#             num1 = 0</span></span><br><span class="line">    <span class="comment">#         elif keys[index] not in time:</span></span><br><span class="line">    <span class="comment">#             num1 = 0</span></span><br><span class="line">    <span class="comment">#         elif keys[index] not in years:</span></span><br><span class="line">    <span class="comment">#             num1 = 0</span></span><br><span class="line">    <span class="comment">#         elif keys[index] not in x:</span></span><br><span class="line">    <span class="comment">#             num1 = 0</span></span><br><span class="line">    <span class="comment">#         elif keys[index] in x:</span></span><br><span class="line">    <span class="comment">#             if keys[index - 1] not in jie:</span></span><br><span class="line">    <span class="comment">#                 num1 = 0</span></span><br><span class="line">    <span class="comment">#         else:</span></span><br><span class="line">    <span class="comment">#             num2 += 1</span></span><br><span class="line">    <span class="comment">#     if num2 &gt; 0:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新处理需要去除停靠词</span></span><br><span class="line"></span><br><span class="line">token_doc = [token.lemma_ <span class="keyword">for</span> token <span class="keyword">in</span> nlp(df[<span class="number">0</span>][<span class="number">0</span>].lower())]</span><br><span class="line"></span><br><span class="line">text_tfidf = dictionary.doc2bow(del_stop(df[<span class="number">3</span>][<span class="number">0</span>]))</span><br><span class="line">similar = index[text_tfidf]</span><br><span class="line">dict_score = <span class="built_in">dict</span>(<span class="built_in">zip</span>(np.arange(<span class="built_in">len</span>(all_name)), similar))</span><br><span class="line">sort_score = <span class="built_in">sorted</span>(<span class="built_in">zip</span>(dict_score.values(), dict_score.keys()), reverse=<span class="literal">True</span>)</span><br><span class="line">print(sort_score[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    print(all_name[sort_score[i][<span class="number">1</span>]])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="提取语句对其进行姓名判断"><a href="#提取语句对其进行姓名判断" class="headerlink" title="提取语句对其进行姓名判断"></a>提取语句对其进行姓名判断</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/23</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> gensim <span class="keyword">import</span> corpora, models, similarities</span><br><span class="line"><span class="keyword">import</span> en_core_web_md</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nlp = en_core_web_md.load()</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取姓名</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;en_name.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    result.append(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, line[:<span class="number">-1</span>].split(<span class="string">&#x27;,&#x27;</span>))))</span><br><span class="line">f.close()</span><br><span class="line">result.pop(<span class="number">0</span>)</span><br><span class="line">result.insert(<span class="number">0</span>, [<span class="string">&#x27;aadi&#x27;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 变成小写去重</span></span><br><span class="line">data = [result[i][<span class="number">0</span>].lower() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result))]</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 将其转换为词典</span></span><br><span class="line">dictionary = corpora.Dictionary([[text] <span class="keyword">for</span> text <span class="keyword">in</span> data])</span><br><span class="line">corpus = [dictionary.doc2bow([text]) <span class="keyword">for</span> text <span class="keyword">in</span> data]</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 将语料转换为tf-idf的索引</span></span><br><span class="line">tfidf_model = models.TfidfModel(corpus)[corpus]</span><br><span class="line">index = similarities.MatrixSimilarity(tfidf_model)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">stop_words = [<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_stop</span>(<span class="params">lines</span>):</span></span><br><span class="line">    token_doc = [token.lemma_ <span class="keyword">for</span> token <span class="keyword">in</span> nlp(lines.lower())]</span><br><span class="line">    key_word = []</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> token_doc:</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> stop_words:</span><br><span class="line">            key_word.append(word)</span><br><span class="line">    <span class="keyword">return</span> key_word</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对数据进行处理</span></span><br><span class="line">data = pd.read_excel(<span class="string">&quot;data.xlsx&quot;</span>, header=<span class="literal">None</span>)</span><br><span class="line">df = np.array(data).tolist()</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">keys = del_stop(df[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 判断标志词</span></span><br><span class="line">symbol = np.array(pd.read_excel(<span class="string">&quot;标志词.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">0</span>]).tolist()</span><br><span class="line"></span><br><span class="line">num = []</span><br><span class="line"><span class="keyword">for</span> words <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> words <span class="keyword">not</span> <span class="keyword">in</span> symbol:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        num.append(words)</span><br><span class="line">        print(<span class="string">f&#x27;有标志词&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 判断是否有时间</span></span><br><span class="line"></span><br><span class="line">time = [<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;day&#x27;</span>, <span class="string">&#x27;minute&#x27;</span>, <span class="string">&#x27;second&#x27;</span>, <span class="string">&#x27;today&#x27;</span>, <span class="string">&#x27;tomorrow&#x27;</span>, <span class="string">&#x27;yesterday&#x27;</span>, <span class="string">&#x27;morning&#x27;</span>, <span class="string">&#x27;bainoon&#x27;</span>, <span class="string">&#x27;afternoon&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;evening&#x27;</span>, <span class="string">&#x27;tonight&#x27;</span>, <span class="string">&#x27;night&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">2022</span>):</span><br><span class="line">    x.append(<span class="string">&#x27;%s&#x27;</span> % i)</span><br><span class="line"></span><br><span class="line">jie = [<span class="string">&#x27;in&#x27;</span>, <span class="string">&#x27;as&#x27;</span>, <span class="string">&#x27;at&#x27;</span>, <span class="string">&#x27;the&#x27;</span>]</span><br><span class="line">years = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">203</span>):</span><br><span class="line">    c = <span class="number">10</span> * i</span><br><span class="line">    years.append(<span class="string">&#x27;%s&#x27;</span> % c + <span class="string">&#x27;s&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line">num1 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(keys)):</span><br><span class="line">    <span class="keyword">if</span> keys[i] <span class="keyword">not</span> <span class="keyword">in</span> symbol:</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> keys[i] <span class="keyword">not</span> <span class="keyword">in</span> time:</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> keys[i] <span class="keyword">not</span> <span class="keyword">in</span> years:</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> keys[i] <span class="keyword">not</span> <span class="keyword">in</span> x:</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> keys[i] <span class="keyword">in</span> x:</span><br><span class="line">        <span class="keyword">if</span> keys[i<span class="number">-1</span>] <span class="keyword">not</span> <span class="keyword">in</span> jie:</span><br><span class="line">            num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        num1 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> num1 &gt; <span class="number">0</span>:</span><br><span class="line">    print(<span class="string">&#x27;有时间判断&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断人名</span></span><br><span class="line"></span><br><span class="line">text_tfidf = dictionary.doc2bow(keys)</span><br><span class="line">similar = index[text_tfidf]</span><br><span class="line"></span><br><span class="line">dict_score = <span class="built_in">dict</span>(<span class="built_in">zip</span>(np.arange(<span class="built_in">len</span>(result)), similar))</span><br><span class="line"></span><br><span class="line">sort_score = <span class="built_in">sorted</span>(<span class="built_in">zip</span>(dict_score.values(), dict_score.keys()), reverse=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h2 id="特征标签"><a href="#特征标签" class="headerlink" title="特征标签"></a>特征标签</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/24</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> en_core_web_md</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nlp = en_core_web_md.load()</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1. 只需要管里面是否存在PROPN即可</span></span><br><span class="line"><span class="string">2. 直接调用spacy进行处理。但是需要进行去除停靠词这些</span></span><br><span class="line"><span class="string">3. 相当于处理了姓名，然后还有一个是symbol标志词</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">stop_words = [<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_stop</span>(<span class="params">lines</span>):</span></span><br><span class="line">    token_doc = [token.lemma_ <span class="keyword">for</span> token <span class="keyword">in</span> nlp(lines.lower())]</span><br><span class="line">    key_word = []</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> token_doc:</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> stop_words:</span><br><span class="line">            key_word.append(word)</span><br><span class="line">    <span class="keyword">return</span> key_word</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 先判定是否存在姓名</span></span><br><span class="line"><span class="comment"># 读取语料</span></span><br><span class="line">input_data = np.array(pd.read_excel(<span class="string">&quot;data.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">0</span>]).tolist()</span><br><span class="line">symbol = np.array(pd.read_excel(<span class="string">&quot;标志词.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">0</span>]).tolist()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.进行pos判断，看是否存在人名</span></span><br><span class="line">pos = [[token.pos_ <span class="keyword">for</span> token <span class="keyword">in</span> nlp(word.lower())] <span class="keyword">for</span> word <span class="keyword">in</span> input_data]</span><br><span class="line">name_pos = []</span><br><span class="line"><span class="keyword">for</span> text <span class="keyword">in</span> pos:</span><br><span class="line">    num = <span class="string">&#x27;O&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;PROPN&#x27;</span> <span class="keyword">in</span> text:</span><br><span class="line">        num = <span class="string">&#x27;B-PER&#x27;</span></span><br><span class="line">    name_pos.append(num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 对symbol进行处理</span></span><br><span class="line">symbol_featrue = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_data)):</span><br><span class="line">    keys = del_stop(input_data[i])</span><br><span class="line">    num_s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> words <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="keyword">if</span> words <span class="keyword">not</span> <span class="keyword">in</span> symbol:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num_s += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> num_s &gt; <span class="number">0</span>:</span><br><span class="line">        symbol_featrue.append(<span class="string">&#x27;B-SY&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        symbol_featrue.append(<span class="string">&#x27;O&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 判断时间是否在里面,创建时间组合</span></span><br><span class="line">ttt = [<span class="string">&#x27;%s&#x27;</span> % i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">2022</span>)]</span><br><span class="line">jie = [<span class="string">&#x27;in&#x27;</span>, <span class="string">&#x27;as&#x27;</span>, <span class="string">&#x27;at&#x27;</span>, <span class="string">&#x27;the&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;to&#x27;</span>, <span class="string">&#x27;by&#x27;</span>]</span><br><span class="line">years = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">203</span>):</span><br><span class="line">    c = <span class="number">10</span> * i</span><br><span class="line">    years.append(<span class="string">&#x27;%s&#x27;</span> % c + <span class="string">&#x27;s&#x27;</span>)</span><br><span class="line">years = years + [<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;years&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给一个时间组合标签</span></span><br><span class="line">time_feature = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_data)):</span><br><span class="line">    keys1 = del_stop(input_data[i])</span><br><span class="line">    num_time = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(keys1)):</span><br><span class="line">        <span class="keyword">if</span> keys1[index] <span class="keyword">in</span> years:</span><br><span class="line">            num_time += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> keys1[index] <span class="keyword">in</span> ttt:</span><br><span class="line">            <span class="keyword">if</span> keys1[index<span class="number">-1</span>] <span class="keyword">in</span> jie:</span><br><span class="line">                num_time += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> num_time &gt; <span class="number">0</span>:</span><br><span class="line">        time_feature.append(<span class="string">&#x27;B-TI&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        time_feature.append(<span class="string">&#x27;O&#x27;</span>)</span><br><span class="line"></span><br><span class="line">feature_name = pd.DataFrame(name_pos, columns=&#123;<span class="string">&#x27;name&#x27;</span>&#125;)</span><br><span class="line">feature_symbol = pd.DataFrame(symbol_featrue, columns=&#123;<span class="string">&#x27;symbol&#x27;</span>&#125;)</span><br><span class="line">feature_time = pd.DataFrame(time_feature, columns=&#123;<span class="string">&#x27;time&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">all_feature = pd.concat([feature_name, feature_symbol, feature_time], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">all_feature.to_excel(<span class="string">&quot;feature_NP.xlsx&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="用spacy进行语料处理"><a href="#用spacy进行语料处理" class="headerlink" title="用spacy进行语料处理"></a>用spacy进行语料处理</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/24</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> en_core_web_md</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nlp = en_core_web_md.load()</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1. 只需要管里面是否存在PROPN即可</span></span><br><span class="line"><span class="string">2. 直接调用spacy进行处理。但是需要进行去除停靠词这些</span></span><br><span class="line"><span class="string">3. 相当于处理了姓名，然后还有一个是symbol标志词</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">stop_words = [<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_stop</span>(<span class="params">lines</span>):</span></span><br><span class="line">    token_doc = [token.lemma_ <span class="keyword">for</span> token <span class="keyword">in</span> nlp(lines.lower())]</span><br><span class="line">    key_word = []</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> token_doc:</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> stop_words:</span><br><span class="line">            key_word.append(word)</span><br><span class="line">    <span class="keyword">return</span> key_word</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 先判定是否存在姓名</span></span><br><span class="line"><span class="comment"># 读取语料</span></span><br><span class="line">input_data = np.array(pd.read_excel(<span class="string">&quot;data.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">0</span>]).tolist()</span><br><span class="line">symbol = np.array(pd.read_excel(<span class="string">&quot;标志词.xlsx&quot;</span>, header=<span class="literal">None</span>)[<span class="number">0</span>]).tolist()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.进行pos判断，看是否存在人名</span></span><br><span class="line">pos = [[token.pos_ <span class="keyword">for</span> token <span class="keyword">in</span> nlp(word.lower())] <span class="keyword">for</span> word <span class="keyword">in</span> input_data]</span><br><span class="line">name_pos = []</span><br><span class="line"><span class="keyword">for</span> text <span class="keyword">in</span> pos:</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;PROPN&#x27;</span> <span class="keyword">in</span> text:</span><br><span class="line">        num = <span class="number">1</span></span><br><span class="line">    name_pos.append(num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 对symbol进行处理</span></span><br><span class="line">symbol_featrue = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_data)):</span><br><span class="line">    keys = del_stop(input_data[i])</span><br><span class="line">    num_s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> words <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="keyword">if</span> words <span class="keyword">not</span> <span class="keyword">in</span> symbol:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num_s += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> num_s &gt; <span class="number">0</span>:</span><br><span class="line">        symbol_featrue.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        symbol_featrue.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 判断时间是否在里面,创建时间组合</span></span><br><span class="line">ttt = [<span class="string">&#x27;%s&#x27;</span> % i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">2022</span>)]</span><br><span class="line">jie = [<span class="string">&#x27;in&#x27;</span>, <span class="string">&#x27;as&#x27;</span>, <span class="string">&#x27;at&#x27;</span>, <span class="string">&#x27;the&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;to&#x27;</span>, <span class="string">&#x27;by&#x27;</span>]</span><br><span class="line">years = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">203</span>):</span><br><span class="line">    c = <span class="number">10</span> * i</span><br><span class="line">    years.append(<span class="string">&#x27;%s&#x27;</span> % c + <span class="string">&#x27;s&#x27;</span>)</span><br><span class="line">years = years + [<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;years&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给一个时间组合标签</span></span><br><span class="line">time_feature = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_data)):</span><br><span class="line">    keys1 = del_stop(input_data[i])</span><br><span class="line">    num_time = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(keys1)):</span><br><span class="line">        <span class="keyword">if</span> keys1[index] <span class="keyword">in</span> years:</span><br><span class="line">            num_time += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> keys1[index] <span class="keyword">in</span> ttt:</span><br><span class="line">            <span class="keyword">if</span> keys1[index<span class="number">-1</span>] <span class="keyword">in</span> jie:</span><br><span class="line">                num_time += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> num_time &gt; <span class="number">0</span>:</span><br><span class="line">        time_feature.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        time_feature.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">feature_name = pd.DataFrame(name_pos, columns=&#123;<span class="string">&#x27;name&#x27;</span>&#125;)</span><br><span class="line">feature_symbol = pd.DataFrame(symbol_featrue, columns=&#123;<span class="string">&#x27;symbol&#x27;</span>&#125;)</span><br><span class="line">feature_time = pd.DataFrame(time_feature, columns=&#123;<span class="string">&#x27;time&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">all_feature = pd.concat([feature_name, feature_symbol, feature_time], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">all_feature.to_excel(<span class="string">&quot;feature.xlsx&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="../images/u=693039364,747309816&fm=26&gp=0.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/09/25/nlp-crf%E6%A8%A1%E5%9E%8B/" data-id="ckh4h5f54002misuebv5a95wf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nlp/" rel="tag">nlp</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-数学建模问题3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%983/" class="article-date">
  <time datetime="2020-09-25T07:35:54.000Z" itemprop="datePublished">2020-09-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mathematical-modeling/">mathematical modeling</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%983/">数学建模问题3</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数学建模问题3"><a href="#数学建模问题3" class="headerlink" title=" 数学建模问题3"></a> 数学建模问题3</h1><p>问题三：在P300脑-机接口系统中，往往需要花费很长时间获取有标签样本来训练模型。为了减少训练时间，请根据附件1所给数据，选择适量的样本作为有标签样本，其余训练样本作为无标签样本，在问题二所得一组最优通道组合的基础上，设计一种学习的方法，并利用问题二的测试数据（char13-char17）检验方法的有效性，同时利用所设计的学习方法找出测试集中的其余待识别目标（char18-char22）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/20</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, cohen_kappa_score</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"><span class="keyword">import</span> scipy.io <span class="keyword">as</span> scio</span><br><span class="line"><span class="keyword">from</span> sklearn.externals <span class="keyword">import</span> joblib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整体数据预测</span></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;S1&#x27;</span></span><br><span class="line">num = <span class="number">13</span></span><br><span class="line">nums = num - <span class="number">13</span></span><br><span class="line"><span class="comment"># S1的训练数据进行标准化</span></span><br><span class="line">feature = pd.read_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_std_train_data.xlsx&quot;</span>)</span><br><span class="line">all_std = preprocessing.scale(np.array(feature.iloc[:, <span class="number">1</span>:]).tolist())</span><br><span class="line"></span><br><span class="line"><span class="comment"># S1对应的标签</span></span><br><span class="line">labels = pd.read_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_all_train_label.xlsx&quot;</span>)[<span class="string">&#x27;label&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取测试集</span></span><br><span class="line"></span><br><span class="line">test_data = pd.read_excel(<span class="string">&quot;E:/EEG数据/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;/%s&quot;</span> % text + <span class="string">&quot;_test_data.xlsx&quot;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                          sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line">std_test = preprocessing.scale(np.array(test_data).tolist())</span><br><span class="line"></span><br><span class="line">test_event = pd.read_excel(<span class="string">&#x27;E:/EEG数据/&#x27;</span> + <span class="string">&#x27;%s&#x27;</span> % text + <span class="string">&#x27;/%s&#x27;</span> % text + <span class="string">&#x27;_test_event.xlsx&#x27;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                           sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取avg_epoch中的数据</span></span><br><span class="line">dataFile = <span class="string">&#x27;E:/EEG数据/locs_data/&#x27;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&#x27;_test_locs.mat&#x27;</span></span><br><span class="line">all_datas = scio.loadmat(dataFile)[<span class="string">&#x27;all_sheet&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取avg_epoch中的数据</span></span><br><span class="line">dataFiles = <span class="string">&#x27;E:/EEG数据/locs_data/&#x27;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&#x27;_test_avg_locs.mat&#x27;</span></span><br><span class="line">avg_datas = scio.loadmat(dataFiles)[<span class="string">&#x27;avg_locs&#x27;</span>]</span><br><span class="line"></span><br><span class="line">X_train, X_test, Y_train, Y_test = train_test_split(all_std, labels,</span><br><span class="line">                                                    stratify=labels, test_size=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">clf = RandomForestRegressor()</span><br><span class="line">clf.fit(X_train, Y_train)</span><br><span class="line">Y_pred = clf.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 去预测test和train</span></span><br><span class="line">pred_y = clf.predict(std_test)</span><br><span class="line"></span><br><span class="line">locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pred_y)):</span><br><span class="line">    <span class="keyword">if</span> pred_y[i] &gt; <span class="number">0.5</span>:</span><br><span class="line">        locs.append(i)</span><br><span class="line"></span><br><span class="line">train_event = test_event</span><br><span class="line">char = []</span><br><span class="line">char_f = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">66</span>):</span><br><span class="line">    <span class="keyword">if</span> train_event[<span class="number">0</span>][i] &gt;= <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        char.append(train_event[<span class="number">1</span>][i])</span><br><span class="line">        char_f.append(train_event[<span class="number">0</span>][i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到想要的标签</span></span><br><span class="line">list_event = []</span><br><span class="line">list_locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt;= locs[i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">            list_event.append(char_f[j])</span><br><span class="line">            list_locs.append(char[j])</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">set</span>(list_event)))</span><br><span class="line"><span class="comment"># 得到想要的mat文件中的数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fff = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(avg_datas[nums][<span class="number">0</span>][<span class="number">0</span>])):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(locs[j] - avg_datas[nums][<span class="number">0</span>][<span class="number">0</span>][i]) &lt;= <span class="number">20</span>:</span><br><span class="line">            fff.append(locs[j])</span><br><span class="line"></span><br><span class="line">list_event1 = []</span><br><span class="line">list_locs1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fff)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt;= fff[i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">            list_event1.append(char_f[j])</span><br><span class="line">            list_locs1.append(char[j])</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">set</span>(list_event1)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ffsh = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    fsh = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(all_datas[nums][k][<span class="number">0</span>])):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(locs[j] - all_datas[nums][k][<span class="number">0</span>][i]) &lt;= <span class="number">20</span>:</span><br><span class="line">                fsh.append(locs[j])</span><br><span class="line">    ffsh.append(fsh)</span><br><span class="line"></span><br><span class="line">all_event = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ffsh)):</span><br><span class="line">    list_event2 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ffsh[k])):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">80</span> &lt;= ffsh[k][i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">                list_event2.append(char_f[j])</span><br><span class="line">    all_event.append(list_event2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># joblib.dump(clf, &quot;s1_rfreg_model.pkl&quot;)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/20</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">import</span> scipy.io <span class="keyword">as</span> scio</span><br><span class="line"><span class="keyword">from</span> sklearn.externals <span class="keyword">import</span> joblib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整体数据预测</span></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rf_model = joblib.load(<span class="string">&quot;s5_rfreg_model.pkl&quot;</span>)</span><br><span class="line">text = <span class="string">&#x27;S5&#x27;</span></span><br><span class="line">num = <span class="number">20</span></span><br><span class="line">print(num)</span><br><span class="line">nums = num - <span class="number">13</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># S1对应的标签</span></span><br><span class="line">labels = pd.read_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_all_train_label.xlsx&quot;</span>)[<span class="string">&#x27;label&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取测试集</span></span><br><span class="line"></span><br><span class="line">test_data = pd.read_excel(<span class="string">&quot;E:/EEG数据/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;/%s&quot;</span> % text + <span class="string">&quot;_test_data.xlsx&quot;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                          sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line">std_test = preprocessing.scale(np.array(test_data).tolist())</span><br><span class="line"></span><br><span class="line">test_event = pd.read_excel(<span class="string">&#x27;E:/EEG数据/&#x27;</span> + <span class="string">&#x27;%s&#x27;</span> % text + <span class="string">&#x27;/%s&#x27;</span> % text + <span class="string">&#x27;_test_event.xlsx&#x27;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                           sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取avg_epoch中的数据</span></span><br><span class="line">dataFile = <span class="string">&#x27;E:/EEG数据/locs_data/&#x27;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&#x27;_test_locs.mat&#x27;</span></span><br><span class="line">all_datas = scio.loadmat(dataFile)[<span class="string">&#x27;all_sheet&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取avg_epoch中的数据</span></span><br><span class="line">dataFiles = <span class="string">&#x27;E:/EEG数据/locs_data/&#x27;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&#x27;_test_avg_locs.mat&#x27;</span></span><br><span class="line">avg_datas = scio.loadmat(dataFiles)[<span class="string">&#x27;avg_locs&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pred_y = rf_model.predict(std_test)</span><br><span class="line"></span><br><span class="line">locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pred_y)):</span><br><span class="line">    <span class="keyword">if</span> pred_y[i] &gt; <span class="number">0.5</span>:</span><br><span class="line">        locs.append(i)</span><br><span class="line"></span><br><span class="line">train_event = test_event</span><br><span class="line">char = []</span><br><span class="line">char_f = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">66</span>):</span><br><span class="line">    <span class="keyword">if</span> train_event[<span class="number">0</span>][i] &gt;= <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        char.append(train_event[<span class="number">1</span>][i])</span><br><span class="line">        char_f.append(train_event[<span class="number">0</span>][i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到想要的标签</span></span><br><span class="line">list_event = []</span><br><span class="line">list_locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt;= locs[i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">            list_event.append(char_f[j])</span><br><span class="line">            list_locs.append(char[j])</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">set</span>(list_event)))</span><br><span class="line"><span class="comment"># 得到想要的mat文件中的数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fff = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(avg_datas[nums][<span class="number">0</span>][<span class="number">0</span>])):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(locs[j] - avg_datas[nums][<span class="number">0</span>][<span class="number">0</span>][i]) &lt;= <span class="number">20</span>:</span><br><span class="line">            fff.append(locs[j])</span><br><span class="line"></span><br><span class="line">list_event1 = []</span><br><span class="line">list_locs1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fff)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt;= fff[i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">            list_event1.append(char_f[j])</span><br><span class="line">            list_locs1.append(char[j])</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">set</span>(list_event1)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ffsh = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    fsh = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(all_datas[nums][k][<span class="number">0</span>])):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(locs[j] - all_datas[nums][k][<span class="number">0</span>][i]) &lt;= <span class="number">20</span>:</span><br><span class="line">                fsh.append(locs[j])</span><br><span class="line">    ffsh.append(fsh)</span><br><span class="line"></span><br><span class="line">all_event = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ffsh)):</span><br><span class="line">    list_event2 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ffsh[k])):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">80</span> &lt;= ffsh[k][i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">                list_event2.append(char_f[j])</span><br><span class="line">    all_event.append(list_event2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后结合输出</p>
<p><img src="../images/timg-1601019488724.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%983/" data-id="ckh4h5f7u006hisue6c2kfxxy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mathematical-modeling/" rel="tag">mathematical modeling</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-数学建模问题2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%982/" class="article-date">
  <time datetime="2020-09-25T07:29:28.000Z" itemprop="datePublished">2020-09-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mathematical-modeling/">mathematical modeling</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%982/">数学建模问题2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数学建模问题2"><a href="#数学建模问题2" class="headerlink" title="数学建模问题2"></a>数学建模问题2</h1><p>特征降维</p>
<p>​         <strong>问题二：</strong>由于采集的原始脑电数据量较大，这样的信号势必包含较多的冗余信息。根据图5和表1，在20个脑电信号采集通道中，无关或冗余的通道数据不仅会增加系统的复杂度，且影响分类识别的准确率和性能。请分析附件1所给数据，并设计一个通道选择算法，给出针对每个被试的、更有利于分类的通道名称组合（要求通道组合的数量小于20大于等于10，每个被试所选的通道可以不相同，具体的通道名称见图5和表1）。基于通道选择的结果，进一步分析对于所有被试都较适用的一组最优通道名称组合，并给出具体分析过程。为了方便参赛者对最优通道组合进行选择，赛题给出了测试数据（char13-char17）的结果，它们的字符分别是：M、F、5、2、I。  </p>
<h2 id="PCA"><a href="#PCA" class="headerlink" title="PCA"></a>PCA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/21</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, cohen_kappa_score, mean_squared_error</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整体数据预测</span></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;S5&#x27;</span></span><br><span class="line">print(text)</span><br><span class="line"><span class="comment"># S1的训练数据进行标准化</span></span><br><span class="line">feature = pd.read_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_std_train_data.xlsx&quot;</span>)</span><br><span class="line">all_std = preprocessing.scale(np.array(feature.iloc[:, <span class="number">1</span>:]).tolist())</span><br><span class="line"></span><br><span class="line"><span class="comment"># S1对应的标签</span></span><br><span class="line">labels = pd.read_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_all_train_label.xlsx&quot;</span>)[<span class="string">&#x27;label&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pca = PCA(n_components=<span class="number">0.95</span>)</span><br><span class="line">feature_pca = pca.fit_transform(all_std)</span><br><span class="line"></span><br><span class="line"><span class="comment"># X_train, X_test, Y_train, Y_test = train_test_split(all_std, labels,</span></span><br><span class="line"><span class="comment">#                                                     stratify=labels, test_size=0.3)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># clf = RandomForestClassifier()</span></span><br><span class="line"><span class="comment"># clf.fit(X_train, Y_train)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Y_pred = clf.predict(X_test)</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="分类模型去测试"><a href="#分类模型去测试" class="headerlink" title="分类模型去测试"></a>分类模型去测试</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/21</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, cohen_kappa_score, f1_score</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">import</span> scipy.io <span class="keyword">as</span> scio</span><br><span class="line"><span class="keyword">from</span> sklearn.externals <span class="keyword">import</span> joblib</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;S5&#x27;</span></span><br><span class="line">num = <span class="number">13</span></span><br><span class="line"></span><br><span class="line">test_data = pd.read_excel(<span class="string">&quot;E:/EEG数据/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;/%s&quot;</span> % text + <span class="string">&quot;_test_data.xlsx&quot;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                          sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line">std_test = preprocessing.scale(np.array(test_data).tolist())</span><br><span class="line"></span><br><span class="line">test_label = pd.read_excel(<span class="string">&#x27;E:/EEG数据/label&#x27;</span> + <span class="string">&quot;/%s&quot;</span> % text + <span class="string">&#x27;_char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num + <span class="string">&#x27;_label.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X_train, X_test, Y_train, Y_test = train_test_split(std_test, test_label.iloc[:, <span class="number">1</span>:],</span><br><span class="line">                                                    stratify=test_label.iloc[:, <span class="number">1</span>:], test_size=<span class="number">0.3</span>)</span><br><span class="line">clf = RandomForestClassifier()</span><br><span class="line">clf.fit(X_train, Y_train)</span><br><span class="line">Y_pred = clf.predict(X_test)</span><br><span class="line"></span><br><span class="line">acr = accuracy_score(Y_test, Y_pred)</span><br><span class="line">kappa = cohen_kappa_score(Y_test, Y_pred)</span><br><span class="line">score = cross_val_score(clf, X_train, Y_train, cv=<span class="number">5</span>)</span><br><span class="line">F1 = f1_score(Y_test, Y_pred, average=<span class="string">&#x27;macro&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="进行模型的训练和结合P300输出"><a href="#进行模型的训练和结合P300输出" class="headerlink" title="进行模型的训练和结合P300输出"></a>进行模型的训练和结合P300输出</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/20</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">from</span> sklearn.externals <span class="keyword">import</span> joblib</span><br><span class="line"><span class="keyword">import</span> scipy.io <span class="keyword">as</span> scio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rf_model = joblib.load(<span class="string">&quot;s1_rfreg_model.pkl&quot;</span>)</span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;S1&#x27;</span></span><br><span class="line"></span><br><span class="line">num = <span class="number">13</span></span><br><span class="line">test_data = pd.read_excel(<span class="string">&quot;E:/EEG数据/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;/%s&quot;</span> % text + <span class="string">&quot;_test_data.xlsx&quot;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                          sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line">test_event = pd.read_excel(<span class="string">&#x27;E:/EEG数据/&#x27;</span> + <span class="string">&#x27;%s&#x27;</span> % text + <span class="string">&#x27;/%s&#x27;</span> % text + <span class="string">&#x27;_test_event.xlsx&#x27;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                           sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line"></span><br><span class="line">std_test = preprocessing.scale(np.array(test_data).tolist())</span><br><span class="line">pred_y = rf_model.predict(std_test)</span><br><span class="line"></span><br><span class="line">dataFiles = <span class="string">&#x27;E:/EEG数据/locs_data/S&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % <span class="number">1</span> + <span class="string">&#x27;_test_locs.mat&#x27;</span></span><br><span class="line">avg_datas = scio.loadmat(dataFiles)[<span class="string">&#x27;all_sheet&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pred_y)):</span><br><span class="line">    <span class="keyword">if</span> pred_y[i] == <span class="number">1</span>:</span><br><span class="line">        locs.append(i)</span><br><span class="line"></span><br><span class="line">char = []</span><br><span class="line">char_f = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">66</span>):</span><br><span class="line">    <span class="keyword">if</span> test_event[<span class="number">0</span>][i] == <span class="number">666</span> <span class="keyword">or</span> test_event[<span class="number">0</span>][i] == <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        char.append(test_event[<span class="number">1</span>][i])</span><br><span class="line">        char_f.append(test_event[<span class="number">0</span>][i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到想要的标签</span></span><br><span class="line">list_event = []</span><br><span class="line">list_locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt;= locs[i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">            list_event.append(char_f[j])</span><br><span class="line">            list_locs.append(char[j])</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">set</span>(list_event)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">top1</span>(<span class="params">lst</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(lst, default=<span class="string">&#x27;列表为空&#x27;</span>, key=<span class="keyword">lambda</span> v: lst.count(v))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(top1(list_event))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fff = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(avg_datas[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>])):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(list_locs)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt;= avg_datas[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][i] - list_locs[j] &lt; <span class="number">120</span>:</span><br><span class="line">            fff.append(list_locs[j])</span><br><span class="line"></span><br><span class="line">finally_event = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fff)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> fff[i] - char[j] == <span class="number">0</span>:</span><br><span class="line">            finally_event.append(char_f[j])</span><br><span class="line">print(finally_event)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="去看所有模型的结果"><a href="#去看所有模型的结果" class="headerlink" title="去看所有模型的结果"></a>去看所有模型的结果</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/20</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">import</span> scipy.io <span class="keyword">as</span> scio</span><br><span class="line"><span class="keyword">from</span> sklearn.externals <span class="keyword">import</span> joblib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整体数据预测</span></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rf_model = joblib.load(<span class="string">&quot;s5_rfreg_model.pkl&quot;</span>)</span><br><span class="line">text = <span class="string">&#x27;S5&#x27;</span></span><br><span class="line">num = <span class="number">20</span></span><br><span class="line">print(num)</span><br><span class="line">nums = num - <span class="number">13</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># S1对应的标签</span></span><br><span class="line">labels = pd.read_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_all_train_label.xlsx&quot;</span>)[<span class="string">&#x27;label&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取测试集</span></span><br><span class="line"></span><br><span class="line">test_data = pd.read_excel(<span class="string">&quot;E:/EEG数据/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;/%s&quot;</span> % text + <span class="string">&quot;_test_data.xlsx&quot;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                          sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line">std_test = preprocessing.scale(np.array(test_data).tolist())</span><br><span class="line"></span><br><span class="line">test_event = pd.read_excel(<span class="string">&#x27;E:/EEG数据/&#x27;</span> + <span class="string">&#x27;%s&#x27;</span> % text + <span class="string">&#x27;/%s&#x27;</span> % text + <span class="string">&#x27;_test_event.xlsx&#x27;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                           sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取avg_epoch中的数据</span></span><br><span class="line">dataFile = <span class="string">&#x27;E:/EEG数据/locs_data/&#x27;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&#x27;_test_locs.mat&#x27;</span></span><br><span class="line">all_datas = scio.loadmat(dataFile)[<span class="string">&#x27;all_sheet&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取avg_epoch中的数据</span></span><br><span class="line">dataFiles = <span class="string">&#x27;E:/EEG数据/locs_data/&#x27;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&#x27;_test_avg_locs.mat&#x27;</span></span><br><span class="line">avg_datas = scio.loadmat(dataFiles)[<span class="string">&#x27;avg_locs&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pred_y = rf_model.predict(std_test)</span><br><span class="line"></span><br><span class="line">locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pred_y)):</span><br><span class="line">    <span class="keyword">if</span> pred_y[i] &gt; <span class="number">0.5</span>:</span><br><span class="line">        locs.append(i)</span><br><span class="line"></span><br><span class="line">train_event = test_event</span><br><span class="line">char = []</span><br><span class="line">char_f = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">66</span>):</span><br><span class="line">    <span class="keyword">if</span> train_event[<span class="number">0</span>][i] &gt;= <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        char.append(train_event[<span class="number">1</span>][i])</span><br><span class="line">        char_f.append(train_event[<span class="number">0</span>][i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到想要的标签</span></span><br><span class="line">list_event = []</span><br><span class="line">list_locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt;= locs[i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">            list_event.append(char_f[j])</span><br><span class="line">            list_locs.append(char[j])</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">set</span>(list_event)))</span><br><span class="line"><span class="comment"># 得到想要的mat文件中的数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fff = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(avg_datas[nums][<span class="number">0</span>][<span class="number">0</span>])):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(locs[j] - avg_datas[nums][<span class="number">0</span>][<span class="number">0</span>][i]) &lt;= <span class="number">20</span>:</span><br><span class="line">            fff.append(locs[j])</span><br><span class="line"></span><br><span class="line">list_event1 = []</span><br><span class="line">list_locs1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fff)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt;= fff[i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">            list_event1.append(char_f[j])</span><br><span class="line">            list_locs1.append(char[j])</span><br><span class="line">print(<span class="built_in">list</span>(<span class="built_in">set</span>(list_event1)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ffsh = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    fsh = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(all_datas[nums][k][<span class="number">0</span>])):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(locs[j] - all_datas[nums][k][<span class="number">0</span>][i]) &lt;= <span class="number">20</span>:</span><br><span class="line">                fsh.append(locs[j])</span><br><span class="line">    ffsh.append(fsh)</span><br><span class="line"></span><br><span class="line">all_event = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ffsh)):</span><br><span class="line">    list_event2 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ffsh[k])):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">80</span> &lt;= ffsh[k][i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">                list_event2.append(char_f[j])</span><br><span class="line">    all_event.append(list_event2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/17</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"><span class="comment"># 解决中文显示问题</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;Microsoft YaHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sheet_names = np.array(pd.read_excel(<span class="string">&#x27;E:/EEG数据/sheet name.xlsx&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> sheet_names[<span class="number">0</span>]:</span><br><span class="line">    data = pd.read_excel(<span class="string">&#x27;E:/EEG数据/S1/S1_train_data.xlsx&#x27;</span>, header=<span class="number">0</span>, sheet_name=name)</span><br><span class="line">    data.columns = [np.arange(<span class="number">1</span>, <span class="number">21</span>)]</span><br><span class="line">    fea = pd.DataFrame(preprocessing.scale(data), columns=data.keys())</span><br><span class="line">    <span class="comment"># tags = pd.read_excel(&#x27;E:/EEG数据/S1/S1_train_event.xlsx&#x27;, header=0, sheet_name=name)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">        fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">        plt.plot(fea[i])</span><br><span class="line">        plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="../images/timg-1601019318341.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%982/" data-id="ckh4h5f81006nisue8v0q4um1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mathematical-modeling/" rel="tag">mathematical modeling</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-数学建模问题1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%981/" class="article-date">
  <time datetime="2020-09-25T07:19:33.000Z" itemprop="datePublished">2020-09-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mathematical-modeling/">mathematical modeling</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%981/">数学建模问题1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数学建模问题1"><a href="#数学建模问题1" class="headerlink" title="数学建模问题1"></a>数学建模问题1</h1><p>想通过提取P300和结合RF回归模型进去预测</p>
<p>问题一：**  在脑-机接口系统中既要考虑目标的分类准确率，同时又要保证一定的信息传输速率。请根据附件1所给数据，<strong>设计或采用一个方法，在尽可能使用较少轮次（要求轮次数小于等于**</strong>5）的测试数据<strong>的情况下，找出附件1中5个被试测试集中的</strong>10个待识别目标**，并给出具体的分类识别过程，可与几种方法进行对比，来说明设计方法的合理性。  </p>
<h2 id="查看频率的波段"><a href="#查看频率的波段" class="headerlink" title="查看频率的波段"></a>查看频率的波段</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/18</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy.signal <span class="keyword">import</span> savgol_filter, firwin, lfilter</span><br><span class="line"><span class="keyword">from</span> scipy.fftpack <span class="keyword">import</span> fft</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_fft_values</span>(<span class="params">y_values, T, N, f_s</span>):</span></span><br><span class="line">    f_values = np.linspace(<span class="number">0.0</span>, <span class="number">1.0</span>/(<span class="number">2.0</span>*T), N//<span class="number">2</span>)</span><br><span class="line">    fft_values_ = fft(y_values)</span><br><span class="line">    fft_values = <span class="number">2.0</span>/N * np.<span class="built_in">abs</span>(fft_values_[<span class="number">0</span>:N//<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> f_values, fft_values</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sheet_names = np.array(pd.read_excel(<span class="string">&#x27;E:/EEG数据/sheet name.xlsx&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> sheet_names[<span class="number">0</span>]:</span><br><span class="line">    data = pd.read_excel(<span class="string">&#x27;E:/EEG数据/S1/S1_train_data.xlsx&#x27;</span>, header=<span class="number">0</span>, sheet_name=name)</span><br><span class="line">    data.columns = [np.arange(<span class="number">1</span>, <span class="number">21</span>)]</span><br><span class="line">    feature = pd.DataFrame(data, columns=data.keys())</span><br><span class="line">    ha = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(feature)):</span><br><span class="line">        ha.append(np.array(feature[<span class="number">1</span>])[i][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    f_values, fft_values = get_fft_values(savgol_filter(ha, <span class="number">53</span>, <span class="number">3</span>), <span class="number">0.04</span>, <span class="built_in">len</span>(ha), <span class="number">250</span>)</span><br><span class="line">    plt.plot(f_values, fft_values, linestyle=<span class="string">&#x27;-&#x27;</span>, color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;Frequency [Hz]&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;Amplitude&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">    plt.title(<span class="string">&quot;Frequency domain of the signal&quot;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="进行低通滤波"><a href="#进行低通滤波" class="headerlink" title="进行低通滤波"></a>进行低通滤波</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/18</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy.signal <span class="keyword">import</span> savgol_filter, firwin, lfilter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sheet_names = np.array(pd.read_excel(<span class="string">&#x27;E:/EEG数据/sheet name.xlsx&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> sheet_names[<span class="number">0</span>]:</span><br><span class="line">    data = pd.read_excel(<span class="string">&#x27;E:/EEG数据/S1/S1_train_data.xlsx&#x27;</span>, header=<span class="number">0</span>, sheet_name=name)</span><br><span class="line">    data.columns = [np.arange(<span class="number">1</span>, <span class="number">21</span>)]</span><br><span class="line">    feature = pd.DataFrame(data, columns=data.keys())</span><br><span class="line">    low_pass = firwin(numtaps=<span class="number">3</span>, cutoff=<span class="number">30</span>, nyq=<span class="number">125</span>)</span><br><span class="line">    y = lfilter(low_pass, <span class="number">1</span>, feature[<span class="number">1</span>])</span><br><span class="line">    fig1 = plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">    plt.plot(y)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    fig2 = plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>))</span><br><span class="line">    plt.plot(feature[<span class="number">1</span>])</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="模型进行预测"><a href="#模型进行预测" class="headerlink" title="模型进行预测"></a>模型进行预测</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/20</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, cohen_kappa_score</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.externals <span class="keyword">import</span> joblib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整体数据预测</span></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;S1&#x27;</span></span><br><span class="line">featrue = pd.read_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_std_train_data.xlsx&quot;</span>)</span><br><span class="line">labels = pd.read_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_all_train_label.xlsx&quot;</span>)[<span class="string">&#x27;label&#x27;</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="number">13</span></span><br><span class="line">test_data = pd.read_excel(<span class="string">&quot;E:/EEG数据/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;/%s&quot;</span> % text + <span class="string">&quot;_test_data.xlsx&quot;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                          sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line"></span><br><span class="line">test_event = pd.read_excel(<span class="string">&#x27;E:/EEG数据/&#x27;</span> + <span class="string">&#x27;%s&#x27;</span> % text + <span class="string">&#x27;/%s&#x27;</span> % text + <span class="string">&#x27;_test_event.xlsx&#x27;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                           sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line">std_test = preprocessing.scale(np.array(test_data).tolist())</span><br><span class="line">clf = RandomForestClassifier()</span><br><span class="line">X_train, X_test, Y_train, Y_test = train_test_split(featrue.iloc[:, <span class="number">1</span>:], labels,</span><br><span class="line">                                                    stratify=labels, test_size=<span class="number">0.3</span>)</span><br><span class="line">clf.fit(X_train, Y_train)</span><br><span class="line">Y_pred = clf.predict(X_test)</span><br><span class="line">acr = accuracy_score(Y_test, Y_pred)</span><br><span class="line">print(acr)</span><br><span class="line"></span><br><span class="line">pred_y = clf.predict(X_test)</span><br><span class="line">locs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pred_y)):</span><br><span class="line">    <span class="keyword">if</span> pred_y[i] == <span class="number">1</span>:</span><br><span class="line">        locs.append(i)</span><br><span class="line">print(locs)</span><br><span class="line"></span><br><span class="line">now = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(locs)):</span><br><span class="line">    <span class="keyword">if</span> locs[i] &lt; <span class="number">330</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        now.append(locs[i])</span><br><span class="line"></span><br><span class="line">char = []</span><br><span class="line">char_f = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">66</span>):</span><br><span class="line">    <span class="keyword">if</span> test_event[<span class="number">0</span>][i] == <span class="number">666</span> <span class="keyword">or</span> test_event[<span class="number">0</span>][i] == <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        char.append(test_event[<span class="number">1</span>][i])</span><br><span class="line">        char_f.append(test_event[<span class="number">0</span>][i])</span><br><span class="line"></span><br><span class="line">list_event = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(now)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(char)):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">80</span> &lt; now[i] - char[j] &lt; <span class="number">120</span>:</span><br><span class="line">            list_event.append(char_f[j])</span><br><span class="line">print(list_event)</span><br><span class="line"><span class="comment"># joblib.dump(clf, &quot;my_model.pkl&quot;)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="20个通道的P300"><a href="#20个通道的P300" class="headerlink" title="20个通道的P300"></a>20个通道的P300</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">clc;clear;close all</span><br><span class="line">[~, Sheet, ~] = xlsfinfo(<span class="string">&#x27;E:\EEG数据\S1\S1_test_data.xlsx&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> index = <span class="number">1</span> : <span class="built_in">length</span>(Sheet)</span><br><span class="line">    eeg_data = xlsread(<span class="string">&#x27;E:\EEG数据\S1\S1_test_data.xlsx&#x27;</span>, Sheet&#123;index&#125;);</span><br><span class="line">    <span class="built_in">i</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">i</span> &lt; <span class="number">21</span></span><br><span class="line">        epoch_eeg = eeg_data(:, <span class="built_in">i</span>);</span><br><span class="line">        [QRS_pks, QRS_locs, delay] = pan_tompkin(epoch_eeg, <span class="number">250</span>, <span class="number">0</span>);</span><br><span class="line">        all_locs(<span class="built_in">i</span>, :) = &#123;QRS_locs&#125;;</span><br><span class="line">        <span class="built_in">i</span> = <span class="built_in">i</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    all_sheet(index, :) = all_locs;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="20个通道叠加后的P300"><a href="#20个通道叠加后的P300" class="headerlink" title="20个通道叠加后的P300"></a>20个通道叠加后的P300</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">clc;clear;close all</span><br><span class="line">[~, Sheet, ~] = xlsfinfo(<span class="string">&#x27;E:\EEG数据\S1\S1_test_data.xlsx&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> index = <span class="number">1</span> : <span class="built_in">length</span>(Sheet)</span><br><span class="line">    filename = [<span class="string">&#x27;E:\EEG数据\avg_epoch\S1_avg_&#x27;</span>, Sheet&#123;index&#125;, <span class="string">&#x27;_test.xlsx&#x27;</span>];</span><br><span class="line">    avg_eeg = xlsread(filename);</span><br><span class="line">    eeg = avg_eeg(<span class="number">2</span>:<span class="keyword">end</span>, <span class="number">2</span>);</span><br><span class="line">    [QRS_pks1, QRS_locs1, delay1] = pan_tompkin(eeg, <span class="number">250</span>, <span class="number">0</span>);</span><br><span class="line">    avg_locs(index, :) = &#123;QRS_locs1&#125;;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<h2 id="生成20个通道的叠加"><a href="#生成20个通道的叠加" class="headerlink" title="生成20个通道的叠加"></a>生成20个通道的叠加</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/18</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy.signal <span class="keyword">import</span> savgol_filter, firwin, lfilter</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"><span class="comment"># 解决中文显示问题</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line"></span><br><span class="line">sheet_names = np.array(pd.read_excel(<span class="string">&#x27;E:/EEG数据/sheet name.xlsx&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> sheet_names[<span class="number">0</span>]:</span><br><span class="line">    data = pd.read_excel(<span class="string">&#x27;E:/EEG数据/S1/S1_train_data.xlsx&#x27;</span>, header=<span class="number">0</span>, sheet_name=name)</span><br><span class="line">    data.columns = [np.arange(<span class="number">1</span>, <span class="number">21</span>)]</span><br><span class="line">    <span class="comment"># 化为标准差</span></span><br><span class="line">    <span class="comment"># 再去基飘</span></span><br><span class="line">    <span class="comment"># 叠加</span></span><br><span class="line">    <span class="comment"># 最后分段</span></span><br><span class="line">    <span class="comment"># 将数据化为标准差</span></span><br><span class="line">    feature = pd.DataFrame(preprocessing.scale(data), columns=data.keys())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对全部数据进行低通滤波</span></span><br><span class="line">    epoch = []</span><br><span class="line">    <span class="comment"># fig = plt.figure(figsize=(10, 8))</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">21</span>):</span><br><span class="line">        <span class="comment"># 低通滤波</span></span><br><span class="line">        low_feature = lfilter(firwin(numtaps=<span class="number">3</span>, cutoff=<span class="number">30</span>, nyq=<span class="number">125</span>), <span class="number">1</span>, feature[i])</span><br><span class="line">        <span class="comment"># plt.plot(low_feature)</span></span><br><span class="line">        epoch.append(low_feature)</span><br><span class="line">    <span class="comment"># plt.show()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 去基飘</span></span><br><span class="line">    all_diff = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(epoch)):</span><br><span class="line">        char01_diff = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(feature)<span class="number">-251</span>):</span><br><span class="line">            char01_diff.append(np.array(feature[j])[<span class="number">251</span>+i] - np.array(feature[j])[i:<span class="number">250</span>+i].mean())</span><br><span class="line">        all_diff.append(char01_diff)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 叠加epoch</span></span><br><span class="line">    avg_epoch = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(epoch[<span class="number">0</span>])):</span><br><span class="line">        epcoh_mean = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(epoch)):</span><br><span class="line">            epcoh_mean.append(epoch[i][j][<span class="number">0</span>])</span><br><span class="line">        one_data = np.array(epcoh_mean).mean()</span><br><span class="line">        avg_epoch.append(one_data)</span><br><span class="line">    datas = pd.DataFrame(avg_epoch)</span><br><span class="line">    <span class="comment"># datas.to_excel(&quot;avg_&quot; + &quot;%s&quot; % name + &quot;.xlsx&quot;)</span></span><br><span class="line">    fig2 = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">    plt.plot(avg_epoch, <span class="string">&quot;r-&quot;</span>, label=<span class="string">&#x27;平滑前&#x27;</span>)</span><br><span class="line">    plt.plot(savgol_filter(avg_epoch, <span class="number">41</span>, <span class="number">3</span>), <span class="string">&quot;b&quot;</span>, label=<span class="string">&#x27;平滑后&#x27;</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&quot;采样点&quot;</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">    plt.xticks(fontsize=<span class="number">12</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&quot;幅值&quot;</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">    plt.yticks(fontsize=<span class="number">12</span>)</span><br><span class="line">    plt.legend(fontsize=<span class="number">12</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    fig2.savefig(<span class="string">&#x27;epoch.png&#x27;</span>, dpi=<span class="number">800</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br></pre></td></tr></table></figure>





<h2 id="生成标签"><a href="#生成标签" class="headerlink" title="生成标签"></a>生成标签</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/18</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sheet_names = np.array(pd.read_excel(<span class="string">&#x27;E:/EEG数据/sheet name.xlsx&#x27;</span>))</span><br><span class="line"></span><br><span class="line">text = <span class="string">&#x27;S1&#x27;</span></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>, <span class="number">18</span>):</span><br><span class="line">    n = [<span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">2</span>]</span><br><span class="line">    m = [<span class="number">7</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">9</span>]</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> sheet_names[num<span class="number">-1</span>]:</span><br><span class="line">        data = pd.read_excel(<span class="string">&#x27;E:/EEG数据/&#x27;</span> + <span class="string">&#x27;%s&#x27;</span> % text + <span class="string">&#x27;/%s&#x27;</span> % text + <span class="string">&#x27;_test_event.xlsx&#x27;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                             sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line">        train_data = pd.read_excel(<span class="string">&quot;E:/EEG数据/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;/%s&quot;</span> % text + <span class="string">&quot;_test_data.xlsx&quot;</span>, header=<span class="literal">None</span>,</span><br><span class="line">                                   sheet_name=<span class="string">&#x27;char&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % num)</span><br><span class="line">        char = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">66</span>):</span><br><span class="line">            <span class="keyword">if</span> data[<span class="number">0</span>][i] == n[num<span class="number">-13</span>]:</span><br><span class="line">                char.append(data[<span class="number">1</span>][i])</span><br><span class="line">            <span class="keyword">elif</span> data[<span class="number">0</span>][i] == m[num<span class="number">-13</span>]:</span><br><span class="line">                char.append(data[<span class="number">1</span>][i])</span><br><span class="line"></span><br><span class="line">        tag = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(train_data)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> char[j] + <span class="number">80</span> &lt;= i &lt; char[j] + <span class="number">120</span>:</span><br><span class="line">                    tag.append(i)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tag.append(<span class="number">0</span>)</span><br><span class="line">        tf = <span class="built_in">list</span>(<span class="built_in">set</span>(tag))</span><br><span class="line">        tf.remove(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        label = []</span><br><span class="line">        <span class="keyword">for</span> nums <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(train_data)):</span><br><span class="line">            c = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tf)):</span><br><span class="line">                <span class="keyword">if</span> tf[j] == nums:</span><br><span class="line">                    c = <span class="number">1</span></span><br><span class="line">            label.append(c)</span><br><span class="line">        labels = pd.DataFrame(label, columns=[<span class="string">&#x27;label&#x27;</span>])</span><br><span class="line">        labels.to_excel(<span class="string">&quot;E:/EEG数据/label/&quot;</span> + <span class="string">&quot;%s&quot;</span> % text + <span class="string">&quot;_%s&quot;</span> % name + <span class="string">&quot;_label.xlsx&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="../images/timg-1601018934159.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%981/" data-id="ckh4h5f7v006kisuehyuu5c0v" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mathematical-modeling/" rel="tag">mathematical modeling</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-数学建模问题4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%984/" class="article-date">
  <time datetime="2020-09-25T07:15:59.000Z" itemprop="datePublished">2020-09-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mathematical-modeling/">mathematical modeling</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%984/">数学建模问题4</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数学建模问题4"><a href="#数学建模问题4" class="headerlink" title="数学建模问题4"></a>数学建模问题4</h1><p><strong>问题四**</strong>：**根据附件2中所给出的特征样本，请设计一个睡眠分期预测模型，在尽可能少的训练样本的基础上，得到相对较高的预测准确率，给出训练数据和测试数据的选取方式和分配比例，说明具体的分类识别过程，并结合分类性能指标对预测的效果进行分析。</p>
<p>预处理后对4个通道。5期数据进行分类，找一个较低的训练与测试比例进行划分，得到一个高准确率。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2020/9/17</span></span><br><span class="line"><span class="comment"># @Author   : esy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">from</span> cross_acr_f1 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略警告</span></span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">feature = pd.read_excel(<span class="string">&#x27;E:/EEG数据/all_sleep.xlsx&#x27;</span>)</span><br><span class="line">std_feature = pd.DataFrame(preprocessing.scale(np.array(feature.iloc[:, <span class="number">1</span>:]).tolist()))</span><br><span class="line"><span class="comment"># std_feature.to_excel(&#x27;标准化数据.xlsx&#x27;)</span></span><br><span class="line"></span><br><span class="line">class_size = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">9</span>):</span><br><span class="line">    X_train, X_test, Y_train, Y_test = train_test_split(std_feature, feature[<span class="string">&#x27;tag&#x27;</span>],</span><br><span class="line">                                                        stratify=feature[<span class="string">&#x27;tag&#x27;</span>], test_size=<span class="number">0.1</span>*i)</span><br><span class="line">    class_size.append(run_cross3(X_train, Y_train))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="../images/timg-1601018339082.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/09/25/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E9%97%AE%E9%A2%984/" data-id="ckh4h5f80006misue1w2kdi3y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mathematical-modeling/" rel="tag">mathematical modeling</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-数学建模和分析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/22/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E5%92%8C%E5%88%86%E6%9E%90/" class="article-date">
  <time datetime="2020-09-22T07:43:07.000Z" itemprop="datePublished">2020-09-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mathematical-modeling/">mathematical modeling</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/22/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E5%92%8C%E5%88%86%E6%9E%90/">数学建模和分析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="赛题分析"><a href="#赛题分析" class="headerlink" title="赛题分析"></a>赛题分析</h1><p>2020年中国研究生数学建模竞赛C题</p>
<p><strong>面向康复工程的脑电信号分析和判别模型</strong></p>
<p>l <strong>背景和意义</strong></p>
<p>大脑是人体中高级神经活动的中枢，拥有着数以亿计的神经元，并通过相互连接来传递和处理人体信息。脑电信号按其产生的方式可分为诱发脑电信号和自发脑电信号。诱发脑电信号是通过某种外界刺激使大脑产生电位变化从而形成的脑电活动；自发脑电信号是指在没有外界特殊刺激下，大脑自发产生的脑电活动。</p>
<p>（1）诱发脑电信号（P300脑-机接口）</p>
<p>在日常生活中，人的大脑控制着感知、思维、运动及语言等功能，且以外围神经为媒介向身体各部分发出指令。因此，当外围神经受损或肌肉受损时，大脑发出指令的传输通路便会受阻，人体将无法正常完成大脑指令的输出，也就失去了与外界交流和控制的能力。研究发现，在外围神经失去作用的情况下，人的大脑依旧可以正常运行，而且其发出指令的部分信息可以通过一些路径表征出来。脑-机接口技术旨在不依赖正常的由外围神经或肌肉组织组成的输出通路的通讯系统，实现大脑与外部辅助设备之间的交流沟通。</p>
<p>P300事件相关电位是诱发脑电信号的一种，在小概率刺激发生后<strong>300**</strong>毫秒范围左右出现的一个正向波峰（相对基线来说呈现向上趋势的波）**。由于个体间的差异性，P300的发生时间也有所不同，图1表示的是在刺激发生后450毫秒左右的P300波形。P300电位作为一种内源性成分，它不受刺激物理特性影响，与知觉或认知心理活动有关，与注意、记忆、智能等加工过程密切相关。基于P300的脑-机接口优点是使用者无需通过复杂训练就可以获得较高的识别准确率，具有稳定的锁时性和高时间精度特性。</p>
<p>（2）自发脑电信号（睡眠脑电）</p>
<p>睡眠是身体休整积蓄能量的重要环节，睡眠质量对人的身心状态也有着重大影响。如何提高睡眠质量，减少睡眠相关疾病对健康的影响，日益受到广泛关注。睡眠过程中采集的脑电信号，属于自发型的脑电信号。<strong>自发型的睡眠脑电信号能够反映身体状态的自身变化，也是用来诊断和治疗相关疾病的重要依据</strong>。</p>
<p>睡眠过程是一个动态变化的复杂过程。在国际睡眠分期的<strong>判读标准**</strong>R&amp;K**<strong>中</strong>，对睡眠过程中的不同状态给出了划分：除去清醒期以外，睡眠周期是由两种睡眠状态交替循环，分别是非快速眼动期和快速眼动期；在非快速眼动期中，根据睡眠状态由浅入深的逐步变化，又进一步分为<strong>睡眠**</strong>I**<strong>期，睡眠**</strong>II**<strong>期，睡眠**</strong>III**<strong>期和睡眠**</strong>IV**<strong>期；睡眠**</strong>III**<strong>期和睡眠**</strong>IV**<strong>期又可合并为深睡眠期</strong>。图2给出了不同睡眠分期对应的脑电信号时序列，自上而下依次为清醒期、睡眠I期、睡眠II期、深睡眠和快速眼动期。从图2中可以观察到，脑电信号在不同睡眠分期所呈现的特点有所不同。基于脑电信号进行自动分期，能够减轻专家医师的人工负担，也是评估睡眠质量、诊断和治疗睡眠相关疾病的重要辅助工具。</p>
<p><strong>图**</strong>2** <strong>各睡眠分期的睡眠脑电信号时序列</strong></p>
<p>l <strong>课题任务</strong></p>
<p>本赛题包含2个附件（数据文件），四个课题任务。具体说明如下，</p>
<p><strong>附件**</strong>1**<strong>：**</strong>P300**<strong>脑机接口实验数据</strong></p>
<p>提供了<strong>5**</strong>个健康成年被试（**<strong>S1-S5**</strong>）<strong>的P300脑机接口实验数据，平均年龄为20岁。在实验的过程中，要求每一位被试（被测试者）集中注意力。P300脑机接口实验的设计如下：每位被试能够观察到一个由</strong>36**<strong>个字符组成的字符矩阵</strong>，如图3所示，字符矩阵以行或列为单位（共6行6列）。每轮实验的设计流程：首先，提示被试注视“目标字符”，例如在图<strong>3**</strong>的字符矩阵上方，出现的灰色字符**<strong>“A”**</strong>；其次，进入字符矩阵的闪烁模式<strong>，每次以随机的顺序闪烁字符矩阵的一行或一列，</strong>闪烁时长为**<strong>80**</strong>毫秒，间隔为**<strong>80**</strong>毫秒<strong>；最后，</strong>当所有行和列均闪烁一次后，则结束一轮实验**。在被试注视“目标字符”的过程中，当目标字符所在行或列闪烁时，脑电信号中会出现P300电位；而当其他行和列闪烁时，则不会出现P300电位。上述实验流程为1轮，共重复5轮</p>
<p>每位被试的P300脑电数据包含有4个文件，具体说明如下，</p>
<p>train_data：训练用数据；</p>
<p>train_event：<strong>训练数据的事件标签</strong>；</p>
<p>test_data：测试用数据；</p>
<p>test_event：<strong>测试数据的事件标签</strong>。</p>
<p>训练用数据包括<strong>12**</strong>个已知目标字符的数据（**<strong>char01~char12**</strong>）<strong>，</strong>测试用数据包括**<strong>10**</strong>个待识别目标字符的数据（**<strong>char13~char22**</strong>）<strong>。每个字符矩阵闪烁实验中，脑电数据</strong>表格包含有**<strong>20**</strong>列<strong>（每列</strong>表示**<strong>1**</strong>个记录通道<strong>，记录通道依次进行编号，表1为记录通道的标识符，图5对应了记录通道的位置），脑电数据表格的行表示样本点数据，采样频率为</strong>250Hz**。信号采集设备设置了参考电极和接地电极，即记录通道的信号为作用电极与参考电极之间的差值。</p>
<table>
<thead>
<tr>
<th></th>
<th><strong>表**</strong>1**<strong>采集通道的标识符</strong>             <strong>标识符</strong>            <strong>通道</strong>    <strong>名称</strong>            <strong>标识符</strong>            <strong>通道</strong>    <strong>名称</strong>                  <strong>1</strong>            Fz            <strong>11</strong>            CP5                  <strong>2</strong>            F3            <strong>12</strong>            CP6                  <strong>3</strong>            F4            <strong>13</strong>            Pz                  <strong>4</strong>            Cz            <strong>14</strong>            P3                  <strong>5</strong>            C3            <strong>15</strong>            P4                  <strong>6</strong>            C4            <strong>16</strong>            P7                  <strong>7</strong>            T7            <strong>17</strong>            P8                  <strong>8</strong>            T8            <strong>18</strong>            Oz                  <strong>9</strong>            CP3            <strong>19</strong>            O1                  <strong>10</strong>            CP4            <strong>20</strong>            O2</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>训练数据中的标签文件同样是以<strong>子表形式与实验数据</strong>相对应，子表的名称为“charXX(Y)”，XX对应相应字符的序列号，<strong>Y**</strong>表示实际的目标字符。子表的内容包含了两列，第一列表示标签，第二列为采样点序号。每轮实验的起始标签为目标字符对应的标识符<strong>（字符矩阵中36个字符的标识符详</strong>见表**<strong>2</strong>，如“101”表示“A”），接下来为闪烁的行或列的标识符（详见图6，<strong>如**</strong>“2”**<strong>表示第**</strong>2**<strong>行，**</strong>“9”**<strong>表示第**</strong>3**<strong>列</strong>），一轮实验的结束标签为“100”。在训练数据的事件标签文件中，<strong>第一行给出了目标字符的标识符和对应的采样点序号</strong>，接下来是随机闪烁的行和列的标识符和对应的采样点序号，每轮实验<strong>以“**</strong>100**<strong>”标识符结束</strong>，共重复5次； </p>
<p>测试数据中的标签文件同样是以子表形式与实验数据相对应，子表的名称为“charXX”，XX对应相应字符的序列号。在测试数据的事件标签文件中，<strong>第一行给出了待识别目标字符的标识符，统一表示为“**</strong>666**<strong>”</strong>，需要通过对脑电信号进行分析后，<strong>得到出现**</strong>P300**<strong>电位的行和列</strong>，并判断得到目标字符的识别结果。</p>
<p><strong>表**</strong>2** <strong>字符矩阵的标识符</strong></p>
<table>
<thead>
<tr>
<th><strong>A</strong></th>
<th>101</th>
<th><strong>B</strong></th>
<th>102</th>
<th><strong>C</strong></th>
<th>103</th>
<th><strong>D</strong></th>
<th>104</th>
<th><strong>E</strong></th>
<th>105</th>
<th><strong>F</strong></th>
<th>106</th>
</tr>
</thead>
<tbody><tr>
<td><strong>G</strong></td>
<td>107</td>
<td><strong>H</strong></td>
<td>108</td>
<td><strong>I</strong></td>
<td>109</td>
<td><strong>J</strong></td>
<td>110</td>
<td><strong>K</strong></td>
<td>111</td>
<td><strong>L</strong></td>
<td>112</td>
</tr>
<tr>
<td><strong>M</strong></td>
<td>113</td>
<td><strong>N</strong></td>
<td>114</td>
<td><strong>O</strong></td>
<td>115</td>
<td><strong>P</strong></td>
<td>116</td>
<td><strong>Q</strong></td>
<td>117</td>
<td><strong>R</strong></td>
<td>118</td>
</tr>
<tr>
<td><strong>S</strong></td>
<td>119</td>
<td><strong>T</strong></td>
<td>120</td>
<td><strong>U</strong></td>
<td>121</td>
<td><strong>V</strong></td>
<td>122</td>
<td><strong>W</strong></td>
<td>123</td>
<td><strong>X</strong></td>
<td>124</td>
</tr>
<tr>
<td><strong>Y</strong></td>
<td>125</td>
<td><strong>Z</strong></td>
<td>126</td>
<td><strong>1</strong></td>
<td>127</td>
<td><strong>2</strong></td>
<td>128</td>
<td><strong>3</strong></td>
<td>129</td>
<td><strong>4</strong></td>
<td>130</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>131</td>
<td><strong>6</strong></td>
<td>132</td>
<td><strong>7</strong></td>
<td>133</td>
<td><strong>8</strong></td>
<td>134</td>
<td><strong>9</strong></td>
<td>135</td>
<td><strong>0</strong></td>
<td>136</td>
</tr>
</tbody></table>
<p><strong>图**</strong>6**<strong>行**</strong>/<strong>**列的标识符</strong></p>
<p><strong>附件**</strong>2**<strong>：睡眠脑电数据</strong></p>
<p>提供3000个睡眠脑电特征样本及其标签，取自不同的健康成年人整夜睡眠过程。第一列为“已知标签”，用数字形式来表示不同的睡眠分期：<strong>清醒期（**</strong>6**<strong>），快速眼动期（**</strong>5**<strong>），睡眠**</strong>I**<strong>期（**</strong>4**<strong>），睡眠**</strong>II**<strong>期（**</strong>3**<strong>），深睡眠期（**</strong>2**<strong>）</strong>；第二至五列为从原始时序列中计算得到的特征参数，依次包括“Alpha”，“Beta”，“Theta”，“Delta”，分别对应了<strong>脑电信号在**</strong>“8-13Hz”**<strong>，**</strong>“14-25Hz”**<strong>，**</strong>“4-7Hz”**<strong>和**</strong>“0.5-4Hz”**<strong>频率范围内的能量占比</strong>，<strong>特征参数单位为百分比</strong>。</p>
<p>根据以上附件所给出的数据来源和实验数据，请研究以下问题：</p>
<p><strong>问题一：</strong>在脑-机接口系统中既要考虑目标的分类准确率，同时又要保证一定的信息传输速率。请根据附件1所给数据，<strong>设计或采用一个方法，在尽可能使用较少轮次（要求轮次数小于等于**</strong>5**<strong>）的测试数据</strong>的情况下，找出附件1中5个被试测试集中的<strong>10**</strong>个待识别目标**，并给出具体的分类识别过程，可与几种方法进行对比，来说明设计方法的合理性。</p>
<p><strong>问题二：</strong>由于采集的原始脑电数据量较大，这样的信号势必包含较多的冗余信息。根据图5和表1，在20个脑电信号采集通道中，无关或冗余的通道数据不仅会增加系统的复杂度，且影响分类识别的准确率和性能。请分析附件1所给数据，并设计一个通道选择算法，给出针对每个被试的、更有利于分类的通道名称组合（要求通道组合的数量小于20大于等于10，每个被试所选的通道可以不相同，具体的通道名称见图5和表1）。基于通道选择的结果，进一步分析对于所有被试都较适用的一组最优通道名称组合，并给出具体分析过程。为了方便参赛者对最优通道组合进行选择，赛题给出了测试数据（char13-char17）的结果，它们的字符分别是：M、F、5、2、I。</p>
<p><strong>问题三：</strong>在P300脑-机接口系统中，往往需要花费很长时间获取有标签样本来训练模型。为了减少训练时间，请根据附件1所给数据，选择适量的样本作为有标签样本，其余训练样本作为无标签样本，在问题二所得一组最优通道组合的基础上，设计一种学习的方法，并利用问题二的测试数据（char13-char17）检验方法的有效性，同时利用所设计的学习方法找出测试集中的其余待识别目标（char18-char22）。</p>
<p><strong>问题四**</strong>：**根据附件2中所给出的特征样本，请设计一个睡眠分期预测模型，在尽可能少的训练样本的基础上，得到相对较高的预测准确率，给出训练数据和测试数据的选取方式和分配比例，说明具体的分类识别过程，并结合分类性能指标对预测的效果进行分析。</p>
<p><strong>注意</strong>：在研究问题一时，不能将问题二提供的5个测试数据的结果作为已知条件，若使用该条件，则被判为作弊处理。</p>
<p>解析：</p>
<p>问题4：</p>
<p>先设计一个分类模型，去看准确率，主要看划分的比例</p>
<p>问题123就是对去预测组合。</p>
<p><img src="/images/u=2576007063,4172196017&fm=26&gp=0.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://esyyes.github.io/2020/09/22/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1%E5%92%8C%E5%88%86%E6%9E%90/" data-id="ckh4h5f890076isue9i4ydf5j" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mathematical-modeling/" rel="tag">mathematical modeling</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/2/">下一页 &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/hexo%E5%AE%8C%E5%96%84/">-hexo完善</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/matlab-%E5%B7%A5%E4%BD%9C/">-matlab -工作</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python%E5%9F%BA%E7%A1%80/">-python基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%87%E7%BA%A7conda/">-升级conda</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E4%BD%9C/">-工作</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E4%BD%9C-matlab/">-工作 -matlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Graduation-work/">Graduation work</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mathematical-modeling/">mathematical modeling</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/matlab/">matlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nlp/">nlp</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/py-study/">py_study</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python%E5%9F%BA%E7%A1%80/">python基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/work/">work</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%B8%E6%88%8F%E4%BA%BA%E7%94%9F/">游戏人生</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/malab-%E6%AF%95%E4%B8%9A/" rel="tag">-malab -毕业</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">-python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">-python -人工智能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" rel="tag">-个人博客搭建</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Graduation-work/" rel="tag">Graduation work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mathematical-modeling/" rel="tag">mathematical modeling</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nlp/" rel="tag">nlp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/py-study/" rel="tag">py_study</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/work/" rel="tag">work</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/malab-%E6%AF%95%E4%B8%9A/" style="font-size: 12px;">-malab -毕业</a> <a href="/tags/python/" style="font-size: 10px;">-python</a> <a href="/tags/python-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 10px;">-python -人工智能</a> <a href="/tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size: 10px;">-个人博客搭建</a> <a href="/tags/Graduation-work/" style="font-size: 14px;">Graduation work</a> <a href="/tags/hexo/" style="font-size: 12px;">hexo</a> <a href="/tags/mathematical-modeling/" style="font-size: 16px;">mathematical modeling</a> <a href="/tags/nlp/" style="font-size: 12px;">nlp</a> <a href="/tags/py-study/" style="font-size: 10px;">py_study</a> <a href="/tags/python/" style="font-size: 18px;">python</a> <a href="/tags/work/" style="font-size: 20px;">work</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/11/04/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2020/11/03/%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87/">分类模型的评估指标</a>
          </li>
        
          <li>
            <a href="/2020/10/21/10-21-%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80/">10-21 爬虫基础</a>
          </li>
        
          <li>
            <a href="/2020/09/25/CRF%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%E7%BB%93%E6%9E%9C/">CRF的整体流程结果</a>
          </li>
        
          <li>
            <a href="/2020/09/25/nlp-crf%E6%A8%A1%E5%9E%8B/">nlp_crf模型</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 esy<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>